<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Inuit_cursor.html">
<link rel="next" href="Inuit_remote.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Inuit" rel="Chapter" href="Inuit.html">
<link title="Inuit_base" rel="Chapter" href="Inuit_base.html">
<link title="Inuit_cursor" rel="Chapter" href="Inuit_cursor.html">
<link title="Inuit_region" rel="Chapter" href="Inuit_region.html">
<link title="Inuit_remote" rel="Chapter" href="Inuit_remote.html">
<link title="Inuit_trace" rel="Chapter" href="Inuit_trace.html">
<link title="Inuit_widget" rel="Chapter" href="Inuit_widget.html"><link title="Constructing regions" rel="Section" href="#1_Constructingregions">
<title>Inuit_region</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Inuit_cursor.html" title="Inuit_cursor">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Inuit_remote.html" title="Inuit_remote">Next</a>
</div>
<h1>Module <a href="type_Inuit_region.html">Inuit_region</a></h1>

<pre><span class="keyword">module</span> Inuit_region: <code class="code"><span class="keyword">sig</span></code> <a href="Inuit_region.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Region is the basic entity through which the buffer is manipulated.
<p>

    It allows to change the text in an abstract way.
    Physical positions (offsets) don't need to be exposed, hence the region
    is made more robust agains concurrent changes.
<p>

    Furthermore, a region can contain arbitrarily many sub-regions.
    Sub-regions cannot overlap, such that sub-regions and their sub-regions
    form a tree which is mapped on the actual text of the buffer.<br>
</div>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">'flags</code> t</span> </pre>
<div class="info ">
Region is the basic entity through which the buffer is manipulated.
<p>

    It allows to change the text in an abstract way.
    Physical positions (offsets) don't need to be exposed, hence the region
    is made more robust agains concurrent changes.
<p>

    Furthermore, a region can contain arbitrarily many sub-regions.
    Sub-regions cannot overlap, such that sub-regions and their sub-regions
    form a tree which is mapped on the actual text of the buffer.<br>
</div>


<pre><span id="VALappend"><span class="keyword">val</span> append</span> : <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -> 'flags list -> string -> unit</code></pre><div class="info ">
Add text to the right end of the region. The meaning of the <code class="code">flags</code> is
    defined by the backend (consumer of the region).<br>
</div>

<pre><span id="VALclear"><span class="keyword">val</span> clear</span> : <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Erase the content of the region.
    All sub-regions are <code class="code">kill</code>ed (erased and closed). See <code class="code">sub</code> to learn more
    about sub-regions.
<p>

    New content can be added again through <code class="code">append</code>.  The most basic way to
    introduce interactivity is by replacing the content of a region.<br>
</div>

<pre><span id="VALkill"><span class="keyword">val</span> kill</span> : <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Erase the content and close the region, see below.<br>
</div>

<pre><span id="VALpropertize"><span class="keyword">val</span> propertize</span> : <code class="type">'flags list -> 'flags <a href="Inuit_region.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Apply some flags on the region<br>
</div>

<pre><span id="TYPEobserver"><span class="keyword">type</span> <code class="type">'flags</code> observer</span> = <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -><br>       <a href="Inuit_region.html#TYPEside">side</a> -><br>       'flags <a href="Inuit_base.Patch.html#TYPEt">Inuit_base.Patch.t</a> -> 'flags list * (unit -> unit) option</code> </pre>
<div class="info ">
One can put an observer to listen to patches applied on a region.
    This is the lowest level way to get feedback from actions done by the
    consumer of the buffer.
<p>

    The observer will get the region the patch applies to, the side which
    produced the patch and the patch itself.
<p>

    When the observer is invoked, the buffer has not yet been modified by the
    patch, and it is incorrect to change the buffer inside the callback.
<p>

    If you want to make changes to the buffer, you can return another function
    which will be invoked as soon as the all pending patches are applied.
<p>

    <code class="code">offset</code> of the patch is absolute. You can use the <code class="code">unsafe_left_offset</code>
    and <code class="code">unsafe_right_offset</code> functions below to get the physical position of
    the region to see which part is affected by the patch.
<p>

    <code class="code">patch</code> can overlap the region if text deleted is larger than the region
    itself.<br>
</div>


<pre><span id="TYPEside"><span class="keyword">type</span> <code class="type"></code>side</span> = <code class="type">[ `Local | `Remote ]</code> </pre>
<div class="info ">
<code class="code"><span class="keywordsign">`</span><span class="constructor">Local</span></code> changes are the one made through the <code class="code"><span class="constructor">Inuit_region</span></code> and
    <code class="code"><span class="constructor">Inuit_cursor</span></code> API.
    <code class="code"><span class="keywordsign">`</span><span class="constructor">Remote</span></code> changes are the one received through the socket.<br>
</div>


<pre><span id="VALsub"><span class="keyword">val</span> sub</span> : <code class="type">?at:[ `Left | `Right ] -><br>       ?observer:'flags <a href="Inuit_region.html#TYPEobserver">observer</a> -><br>       'flags <a href="Inuit_region.html#TYPEt">t</a> -> 'flags <a href="Inuit_region.html#TYPEt">t</a></code></pre><div class="info ">
Create a sub-region at the right end of the region.
    The new region is an empty.
    The effect of this function is to turn
         <code class="code">...&nbsp;region1&nbsp;...&nbsp;text&nbsp;...</code>
    into <code class="code">...&nbsp;region1&nbsp;...&nbsp;text&nbsp;...[region2]</code>, where <code class="code">region2</code> is empty.<br>
</div>

<pre><span id="VALis_closed"><span class="keyword">val</span> is_closed</span> : <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -> bool</code></pre><div class="info ">
A region is closed if it no longer has any listener, such that changes
    applied to it will never be observed again.
<p>

    You can for instance use this to skip expensive computations to produce
    text that will anyway never be useful.<br>
</div>

<pre><span id="VALunsafe_left_offset"><span class="keyword">val</span> unsafe_left_offset</span> : <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -> int</code></pre><div class="info ">
Get the physical position of the region of the left end of the region.
<p>

    It is unsafe because physical positions refers to the current version of
    the buffer and might get invalidated by any change.
<p>

    Also, result of <code class="code">unsafe_left_offset</code> is not specified on a closed region.<br>
</div>

<pre><span id="VALunsafe_right_offset"><span class="keyword">val</span> unsafe_right_offset</span> : <code class="type">'flags <a href="Inuit_region.html#TYPEt">t</a> -> int</code></pre><div class="info ">
Get the physical position of the region of the right end of the region.
    The remarks of <code class="code">unsafe_left_offset</code> also apply here.<br>
</div>
<br>
<h1 id="1_Constructingregions">Constructing regions</h1><br>

<pre><span id="VALmake"><span class="keyword">val</span> make</span> : <code class="type">unit -> 'flags <a href="Inuit_region.html#TYPEt">t</a> * 'flags <a href="Inuit_base.html#TYPEpatch">Inuit_base.patch</a> <a href="Inuit_base.html#TYPEsocket">Inuit_base.socket</a></code></pre><div class="info ">
Return a new root region and the socket to which the patches will be
    streamed.
    The socket should be connected to a consumer before any changes is done.<br>
</div>

<pre><span id="VALnull"><span class="keyword">val</span> null</span> : <code class="type">'a <a href="Inuit_region.html#TYPEt">t</a></code></pre><div class="info ">
A dummy region that is always closed. Useful as a placeholder.<br>
</div>
</body></html>