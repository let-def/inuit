<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Inuit_base.Patch.html">
<link rel="Up" href="Inuit_base.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Inuit" rel="Chapter" href="Inuit.html">
<link title="Inuit_base" rel="Chapter" href="Inuit_base.html">
<link title="Inuit_cursor" rel="Chapter" href="Inuit_cursor.html">
<link title="Inuit_region" rel="Chapter" href="Inuit_region.html">
<link title="Inuit_remote" rel="Chapter" href="Inuit_remote.html">
<link title="Inuit_trace" rel="Chapter" href="Inuit_trace.html">
<link title="Inuit_widget" rel="Chapter" href="Inuit_widget.html"><title>Inuit_base.Socket</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Inuit_base.Patch.html" title="Inuit_base.Patch">Previous</a>
&nbsp;<a class="up" href="Inuit_base.html" title="Inuit_base">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Inuit_base.Socket.html">Inuit_base.Socket</a></h1>

<pre><span class="keyword">module</span> Socket: <code class="code"><span class="keyword">sig</span></code> <a href="Inuit_base.Socket.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><hr width="100%">

<pre><span id="TYPEcontroller"><span class="keyword">type</span> <code class="type">'a</code> controller</span> </pre>
<div class="info ">
A <code class="code">message&nbsp;<span class="constructor">Socket</span>.controller</code> is a bidirectional stream of <code class="code">message</code>.
      The creator of a value of this type can:<ul>
<li>be notified when connection is established or lost,</li>
<li>be notified when a value of type <code class="code">message</code> is received,</li>
<li>send messages to the other end,</li>
<li>terminates the connection.</li>
</ul>
<br>
</div>


<pre><span id="VALmake"><span class="keyword">val</span> make</span> : <code class="type">receive:('a -> unit) -> 'a <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a></code></pre><div class="info ">
<code class="code">make&nbsp;~receive</code> creates a new controller that will call <code class="code">receive</code> when a
      message is received.<br>
</div>

<pre><span id="VALset_receive"><span class="keyword">val</span> set_receive</span> : <code class="type">'a <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a> -> ('a -> unit) -> unit</code></pre><div class="info ">
<code class="code">set_receive</code> sets the callback invoked when a message is received.
<p>
<code class="code">set_on_closed</code> sets the callback invoked when the connection terminates.
      Closing is definitive (it can happen at most once).<br>
</div>

<pre><span id="VALset_on_closed"><span class="keyword">val</span> set_on_closed</span> : <code class="type">'a <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a> -> (unit -> unit) -> unit</code></pre><div class="info ">
<code class="code">set_on_connected</code> sets the callback invoked when the connection is
      established. It can be invoked at most once.<br>
</div>

<pre><span id="VALset_on_connected"><span class="keyword">val</span> set_on_connected</span> : <code class="type">'a <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a> -> (unit -> unit) -> unit</code></pre>
<pre><span id="VALsend"><span class="keyword">val</span> send</span> : <code class="type">'msg <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a> -> 'msg -> unit</code></pre><div class="info ">
<code class="code">send&nbsp;ctrl&nbsp;msg</code> sends one message to the other end.
      <code class="code">status&nbsp;(endpoint&nbsp;ctrl)</code> should be <code class="code"><span class="keywordsign">`</span><span class="constructor">Connected</span></code> for this to succeed.
      Fail with <code class="code"><span class="constructor">Invalid_argument</span></code> otherwise.<br>
</div>

<pre><span id="VALclose"><span class="keyword">val</span> close</span> : <code class="type">'msg <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a> -> unit</code></pre><div class="info ">
<code class="code">close&nbsp;ctrl</code> terminates the connection now.
      If <code class="code">status&nbsp;(endpoint&nbsp;ctrl)</code> is <code class="code"><span class="keywordsign">`</span><span class="constructor">Pending</span></code> or <code class="code"><span class="keywordsign">`</span><span class="constructor">Connected</span></code>, it is updated
      to <code class="code"><span class="keywordsign">`</span><span class="constructor">Closed</span></code> and <code class="code">on_closed</code> callback is invoked.
      If <code class="code">status&nbsp;(endpoint&nbsp;ctrl)</code> is already <code class="code"><span class="keywordsign">`</span><span class="constructor">Closed</span></code>, nothing happens.<br>
</div>

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">'a</code> t</span> </pre>
<div class="info ">
A handle exposed to higher-level code to connect sockets together.<br>
</div>


<pre><span id="VALendpoint"><span class="keyword">val</span> endpoint</span> : <code class="type">'a <a href="Inuit_base.Socket.html#TYPEcontroller">controller</a> -> 'a <a href="Inuit_base.Socket.html#TYPEt">t</a></code></pre>
<pre><span id="VALstatus"><span class="keyword">val</span> status</span> : <code class="type">'msg <a href="Inuit_base.Socket.html#TYPEt">t</a> -> [ `Closed | `Connected | `Pending ]</code></pre><div class="info ">
Get the status of the socket.
      Possible statuses are:<ul>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Pending</span></code>, connection has not been established yet, no message
        should be sent yet.</li>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Connected</span></code>, connection has been established, messages can be sent.</li>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Closed</span></code>, connection is terminated, no messages can be sent anymore.</li>
</ul>
<br>
</div>

<pre><span id="VALconnect"><span class="keyword">val</span> connect</span> : <code class="type">a:'msg <a href="Inuit_base.Socket.html#TYPEt">t</a> -> b:'msg <a href="Inuit_base.Socket.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Connect two sockets together.  Both should be in <code class="code"><span class="keywordsign">`</span><span class="constructor">Pending</span></code> status.
      Fail with <code class="code"><span class="constructor">Invalid_argument</span></code> otherwise.<br>
</div>
</body></html>